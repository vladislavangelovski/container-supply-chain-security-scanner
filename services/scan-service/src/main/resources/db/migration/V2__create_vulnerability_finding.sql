CREATE TABLE vulnerability_finding (
    id UUID PRIMARY KEY,
    report_id UUID NOT NULL REFERENCES scan_report(id) ON DELETE CASCADE,
    pkg_name TEXT,
    cve TEXT,
    severity TEXT,
    fixed_version TEXT,
    created_at TIMESTAMPTZ NOT NULL DEFAULT now()
);

CREATE INDEX IF NOT EXISTS vf_by_report ON vulnerability_finding(report_id);
CREATE INDEX IF NOT EXISTS vf_by_severity ON vulnerability_finding(severity);
CREATE INDEX IF NOT EXISTS vf_by_cve ON vulnerability_finding(cve);
